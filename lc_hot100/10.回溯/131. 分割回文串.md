```cpp
class Solution {
public:
    vector<vector<string>> res;
    vector<string> temp;
    vector<vector<string>> partition(string s) {
        int n = s.size();

        vector<vector<bool>> isPal(n,vector<bool>(n,false));
        for(int i = 0;i<n;i++) isPal[i][i] = true;
        for(int len = 2;len<=n;len++)
        {
            for(int left = 0;left + len - 1 < n;left ++)
            {
                //right-left +1 = len
                int right = left + len - 1;
                if(len<=3)
                {
                    isPal[left][right] = (s[left] == s[right]);
                }
                else
                {
                    isPal[left][right] = (s[left] == s[right]) && isPal[left+1][right-1];
                }
            }
        }

        dfs(isPal,s,0);

        return res;
    }

    void dfs(vector<vector<bool>> &isPal,string s,int u)
    {
        int n = s.size();
        if(u == n)
        {
            res.push_back(temp);
            return ;
        }

        for(int i = u;i<n;i++)
        {
            if(isPal[u][i])
            {
                temp.push_back(s.substr(u,i-u+1));
                dfs(isPal,s,i+1);
                temp.pop_back();
            }
        }
    }
};
```

```python
class Solution:
    def partition(self, s: str) -> List[List[str]]:
        n = len(s)
        res = []
        temp = []
        def dfs(i):
            if n == i:
                res.append(temp[:])
                return

            for j in range(i,n):
                t = s[i:j + 1]
                if t == t[::-1]:
                    temp.append(t)
                    dfs(j+1)
                    temp.pop()
            return

        dfs(0)
        return res
```
